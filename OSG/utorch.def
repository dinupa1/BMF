Bootstrap: docker
From: ubuntu:latest


%post
    # Update the package lists and install required dependencies
    apt-get update && apt-get install -y wget bzip2

    # Download and install Miniforge
    wget https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh -O /tmp/miniforge.sh
    /bin/bash /tmp/miniforge.sh -b -p /opt/miniforge3

    # Create a new conda environment and install PyTorch
    # /opt/miniforge3/bin/conda create -n utorch python=3.10 uproot hist matplotlib root pandas pytorch pytorch-cuda=11.8 -c pytorch -c nvidia -y

    /opt/miniforge3/bin/conda create -n utorch python=3.10 uproot matplotlib pytorch -c pytorch -y


%test
    grep -q NAME=\"Ubuntu\" /etc/os-release
    if [ $? -eq 0 ]; then
        echo "Container base is Ubuntu as expected."
    else
        echo "Container base is not Ubuntu."
        exit 1
    fi

%labels
    Author dinupa3@gmail.com
    Version v0.0.1

# /bin/bash -c "source /opt/miniforge3/bin/activate utorch && python <path-to-python-file>"
